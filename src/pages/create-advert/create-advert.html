<ion-header>
	<ion-navbar hideBackButton>
		<ion-buttons left>
			<button ion-button (click)="tryToGoBack()">
            <ion-icon class="customIcon" name="arrow-back"></ion-icon>
        </button>
		</ion-buttons>
		<ion-title *ngIf="!editingAnAdvert">Create Advert</ion-title>
		<ion-title *ngIf="editingAnAdvert">Edit Advert</ion-title>
	</ion-navbar>
</ion-header>

<ion-content padding text-center>

	<div *ngIf="!this.userService.isSomeoneLoggedIn()">
		<p>You need to login or register to create an advert</p>
		<p><button block ion-button (click)="toLogin()">Login</button></p>
	</div>

	<div *ngIf="this.userService.isSomeoneLoggedIn()">
		<input id="fileUpload" type="file" (change)="fileChangeEvent($event)" accept="video/*"/>
		<label class="upload-label" for="fileUpload" (click)="resetVideo()">
			<ion-icon padding-right md="md-download" ios="md-download" wp="md-download" name="download"></ion-icon>
			Choose a video
		</label>

		<button *ngIf="isUsingCordova" block (click)="recordVideo()" ion-button color="secondary" round class="center-h"><ion-icon padding-right name="videocam"></ion-icon>Record Advert</button>

		<video-component *ngIf="videoData" [src]="videoData[0].fullPath"></video-component>

		<form name="form" (ngSubmit)="f.form.valid && createAdvert()" #f="ngForm" novalidate>
			<ion-item no-padding>
				<ion-label floating>Advert title</ion-label>
				<ion-input name="title" type="text" [(ngModel)]="model.title" #title="ngModel" required autocapitalize="off" autocorrect="off"></ion-input>
			</ion-item>
			<ion-item no-padding>
				<ion-label floating>Description</ion-label>
				<ion-input name="description" type="text" [(ngModel)]="model.description" #description="ngModel" required autocapitalize="off"
				autocorrect="off"></ion-input>
			</ion-item>
			<ion-item no-padding>
				<ion-label floating>Price</ion-label>
				<ion-input name="price" type="number" [(ngModel)]="model.price" #price="ngModel" autocapitalize="off" autocorrect="off"></ion-input>
			</ion-item>
			<ion-item no-padding>
				<ion-label floating>County</ion-label>
				<ion-select required [(ngModel)]="model.county" name="county">
					<ion-option *ngFor="let county of countiesList" [value]="county">{{county}}</ion-option>
				</ion-select>
			</ion-item>
			<div class="form-group">
				<p>
					<button *ngIf="!editingAnAdvert" [disabled]="!f.form.valid" block ion-button>Create advert</button>
					<button *ngIf="editingAnAdvert" [disabled]="!f.form.valid" block ion-button>Save changes</button>
				</p>
			</div>
		</form>
	</div>

</ion-content>